#!/bin/bash

# Update the package list
sudo apt update

# Install ClamAV and ClamAV Daemon
echo "Installing ClamAV..."
sudo apt install -y clamav clamav-daemon
sudo freshclam  # Update the ClamAV database

# Install Linux Malware Detect (LMD)
echo "Installing Linux Malware Detect..."
wget https://www.rfxn.com/downloads/maldetect-current.tar.gz -O /tmp/maldetect-current.tar.gz
tar -xzf /tmp/maldetect-current.tar.gz -C /tmp/
cd $(find /tmp -maxdepth 1 -type d -name 'maldetect-*' | head -n 1) || exit
sudo ./install.sh

# Install Chkrootkit
echo "Installing Chkrootkit..."
sudo apt install -y chkrootkit

# Install Rkhunter
echo "Installing Rootkit Hunter..."
sudo apt install -y rkhunter
sudo rkhunter --update

# Install Sophos Antivirus (Free Edition)
echo "Installing Sophos Antivirus..."
SOPHOS_URL="https://downloads.sophos.com/tools/sav-linux-free-9.tgz"
wget $SOPHOS_URL -O /tmp/sophos-av.tgz
tar -xzf /tmp/sophos-av.tgz -C /tmp/
cd /tmp/sophos-av || exit
sudo ./install.sh --acceptlicence --default && sudo /opt/sophos-av/bin/savdctl start

# Install ClamTk (GUI for ClamAV)
echo "Installing ClamTk..."
sudo apt install -y clamtk

# Install OpenVAS (Greenbone Vulnerability Manager)
echo "Installing OpenVAS..."
sudo apt install -y openvas
gsudo gvm-setup

echo "All tools have been installed successfully!"

# Cleanup temporary files
echo "Cleaning up..."
rm -rf /tmp/maldetect-current.tar.gz /tmp/maldetect-* /tmp/sophos-av /tmp/sophos-av.tgz

# Display post-installation notes
echo -e "\nPost-installation notes:\n"
echo "- For ClamAV, run 'sudo clamscan -r /path/to/scan' to scan files."
echo "- For LMD, use 'sudo maldet --scan-all /path/to/scan'."
echo "- For Chkrootkit, run 'sudo chkrootkit'."
echo "- For Rkhunter, run 'sudo rkhunter --check'."
echo "- For Sophos, scan files using '/opt/sophos-av/bin/savscan /path/to/scan'."
echo "- OpenVAS requires additional configuration after installation."
